<h1>Messages</h1>
<h1><%= @group.name %></h1>
<%= render 'shared/messages/form', group: @group, message: @message %>
<h2>Messages</h2>
<div class="bottom" id="comment_section">
  <% @group.messages.reverse.each do |message| %>
  <p><%= message.content %></p>
  <p><%= message.user.email %></p>
  <% end %>
</div>
<script>
  let channel = pusher.subscribe('comment-channel');
  channel.bind('new-comment', (data) => {
    let comment = data.message.content;
    let email = data.message.email
    let div = document.getElementById('comment_section');
    div.insertAdjacentHTML('afterbegin',`<p> ${email}</p>`);
    div.insertAdjacentHTML('afterbegin',`<p> ${comment}</p>`);
    document.getElementById('message_content').value = "";
  });
</script>
<div class="Group">
  <% if @group.photo.attached? %>
    <h1><%= cl_image_tag @group.photo.key %></h1>
  <% end %>
  <h1><%= @group.name %></h1>
  <h6><%= @resort.name %></h6>
  <h6><%= @resort.country.name %></h6>
  <h4><%= @group.description %></h4>
  <h6>Created by</h6>
    <%@group.memberships.each do |membership|%>
      <%=  membership.user.first_name if membership.admin %>
    <% end %>
  <h6>At<%= @group.created_at %></h6>

  <h2><%= link_to "Edit group", edit_group_path(@group) %></h2>
  <h2><%= link_to "Delete group", group_path(@group), method: :delete, data: { confirm: "Are you sure?" } %></h2>
</div>
